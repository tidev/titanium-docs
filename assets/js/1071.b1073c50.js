(window.webpackJsonp=window.webpackJsonp||[]).push([[1071],{1025:function(t,e,s){"use strict";s.r(e);var a=s(21),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"android-services"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#android-services"}},[t._v("#")]),t._v(" Android Services")]),t._v(" "),s("h2",{attrs:{id:"introduction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),s("p",[t._v("An Android service is a component started by an application that runs in the background. The service does not have any application UI associated with it, so the user does not directly interact with it, only your application. The service continues to run if the user backgrounds the application, such as when switching to a different application or hitting the "),s("strong",[t._v("Home")]),t._v(" button.")]),t._v(" "),s("p",[t._v("The Titanium SDK gives you the ability to write your own Android Services using JavaScript but with some limitations:")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Can only run at intervals that you specify (or only once).")])]),t._v(" "),s("li",[s("p",[t._v("Can only be started programmatically by the Titanium application that defined it. They cannot be declared in the Android manifest and started by a separate application.")])]),t._v(" "),s("li",[s("p",[t._v("May stop running if the application is killed, even though the service is restarted.")])])]),t._v(" "),s("h2",{attrs:{id:"types-of-services"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#types-of-services"}},[t._v("#")]),t._v(" Types of services")]),t._v(" "),s("p",[t._v("In Android, services can either be started or bound:")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("A "),s("em",[t._v("started service")]),t._v(" is a service started by the application, but the application has no direct reference to the service. It runs freely in the background. If the application is destroyed, the service continues to run.")])]),t._v(" "),s("li",[s("p",[t._v("A "),s("em",[t._v("bound service")]),t._v(" is a service started by the application, where the application binds itself to the service. If the application is destroyed, the service is destroyed.")])])]),t._v(" "),s("p",[t._v("In Titanium, there really is not a distinction between the two services. The only difference is:")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("A started service is a service created and started by a Titanium application and may stop running if the application is destroyed.")])]),t._v(" "),s("li",[s("p",[t._v("A bound services is a service created by a Titanium application, which returns a reference to a Service object that the application can invoke methods on to start and stop the service, and bind callbacks to.")])])]),t._v(" "),s("p",[t._v("These services are discussed in more detail below.")]),t._v(" "),s("h2",{attrs:{id:"create-a-javascript-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-a-javascript-service"}},[t._v("#")]),t._v(" Create a JavaScript service")]),t._v(" "),s("p",[t._v("To create a JavaScript service:")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Create a JavaScript file with the code to execute.")])]),t._v(" "),s("li",[s("p",[t._v("Declare the JavaScript file as a service in the "),s("code",[t._v("tiapp.xml")]),t._v(" file.")])]),t._v(" "),s("li",[s("p",[t._v("Create a service intent referencing the JavaScript file using the "),s("code",[t._v("Titanium.Android.createServiceIntent()")]),t._v(" method and set the interval to run the code using the intent's "),s("code",[t._v("putExtra()")]),t._v(" method, then:")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Start a started service using the intent using the "),s("code",[t._v("Titanium.Android.startService()")]),t._v(" method.")])]),t._v(" "),s("li",[s("p",[t._v("Create a bound service using the intent with the "),s("code",[t._v("Titanium.Android.createService()")]),t._v(" method and start the bound service using the service's "),s("code",[t._v("start()")]),t._v(" method.")])])])])]),t._v(" "),s("h3",{attrs:{id:"service-code"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#service-code"}},[t._v("#")]),t._v(" Service code")]),t._v(" "),s("p",[t._v("Code your JavaScript service using the Titanium APIs, specifically the non-UI APIs, such as "),s("code",[t._v("Ti.API.info()")]),t._v(" or "),s("code",[t._v("Ti.Network.createHTTPClient()")]),t._v(".")]),t._v(" "),s("p",[t._v("Place the file in either the "),s("code",[t._v("app/lib")]),t._v(" folder for Alloy projects or the "),s("code",[t._v("Resources")]),t._v(" folder for classic Titanium projects. You can place the file in subfolders within either of those folders. When referencing the file URL, do not include the "),s("code",[t._v("app/lib")]),t._v(" or "),s("code",[t._v("Resources")]),t._v(" folder, or start the URL with a slash ('/').")]),t._v(" "),s("p",[t._v("Use the "),s("code",[t._v("Titanium.Android.Service")]),t._v(" API to manage to the service. To get a reference to the service, use the "),s("code",[t._v("Titanium.Android.currentService")]),t._v(" property inside the JavaScript service code to retrieve a reference to the service, then invoke the "),s("code",[t._v("Titanium.Android.Service")]),t._v(" APIs on the "),s("code",[t._v("Service")]),t._v(" object. With the "),s("code",[t._v("Service")]),t._v(" object, you can:")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Use the"),s("code",[t._v("intent")]),t._v(" property to retrieve the intent that started the service to get extra data that was added to the intent.")])]),t._v(" "),s("li",[s("p",[t._v("Use the "),s("code",[t._v("serviceInstanceId")]),t._v(" property to retrieve the instance ID of the service. A service can be started multiple times and have multiple instances running.")])]),t._v(" "),s("li",[s("p",[t._v("Invoke the "),s("code",[t._v("start()")]),t._v(" method to start the service. Only used with bound services.")])]),t._v(" "),s("li",[s("p",[t._v("Invoke the "),s("code",[t._v("stop()")]),t._v(" method to stop the service.")])]),t._v(" "),s("li",[s("p",[t._v("Monitor the "),s("code",[t._v("pause")]),t._v(" event to know when the service enters the pause state. Fired when the code finishes executing.")])]),t._v(" "),s("li",[s("p",[t._v("Monitor the "),s("code",[t._v("resume")]),t._v(" event to know when the service enters the resume state. Fired when the code is executed.")])]),t._v(" "),s("li",[s("p",[t._v("Monitor the "),s("code",[t._v("start")]),t._v(" event to know when the service starts. Only used with bound services.")])]),t._v(" "),s("li",[s("p",[t._v("Monitor the "),s("code",[t._v("stop")]),t._v(" event to know when the service stops. Only used with bound services.")])]),t._v(" "),s("li",[s("p",[t._v("Monitor the "),s("code",[t._v("taskremoved")]),t._v(" event to know if the application that started the service is destroyed. Only used with started services.")])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("ðŸ’¡ Hint")]),t._v(" "),s("p",[t._v("To retrieve extras sent with the intent, call the intent's "),s("code",[t._v("hasExtra()")]),t._v(" method and pass it the property to retrieve to verify the data exists, then call one of the intent's "),s("code",[t._v("get*Extra()")]),t._v(" methods and pass it the same property name to retrieve the data.")]),t._v(" "),s("p",[t._v("The example below checks for EXTRA_TEXT data sent with the intent.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" extra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasExtra")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EXTRA_TEXT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("extra "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" intent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getStringExtra")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EXTRA_TEXT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Do something with the extra")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("p",[t._v("The example below demonstrates the usage of some of the service APIs. The service monitors some of its events and stops itself after ten iterations.")]),t._v(" "),s("p",[s("strong",[t._v("someService.js")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Grab a reference to the service and its intent")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" service "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" serviceIntent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("intent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nTi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("API")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("serviceInstanceId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Bind event listeners to the service")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("App"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBool")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bind'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("App"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setInt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inc'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'taskremoved'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("API")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'**************************** taskremoved fired'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pause'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("API")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'**************************** pause fired'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'resume'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("API")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'**************************** resume fired'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("App"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setBool")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bind'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("App"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inc'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Stop the service")]),t._v("\n    service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stop")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceIntent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("App"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setInt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inc'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("count"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"declare-a-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#declare-a-service"}},[t._v("#")]),t._v(" Declare a service")]),t._v(" "),s("p",[t._v("For both started and bound services, you need to declare the JavaScript file as a service in the "),s("code",[t._v("tiapp.xml")]),t._v(" file.")]),t._v(" "),s("p",[s("strong",[t._v("To declare a service:")])]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Add the "),s("code",[t._v("<services>")]),t._v(" element as a child of the "),s("code",[t._v("<android>")]),t._v(" element.")])]),t._v(" "),s("li",[s("p",[t._v("For each service, add a "),s("code",[t._v("<service>")]),t._v(" element as a child of the "),s("code",[t._v("<services>")]),t._v(" element. Set the "),s("code",[t._v("url")]),t._v(" attribute to the URL of the JavaScript file and the "),s("code",[t._v("type")]),t._v(" attribute to "),s("code",[t._v("interval")]),t._v(". Currently, "),s("code",[t._v("interval")]),t._v(" is the only supported type, which indicates the code will be run at intervals. The interval is set when creating the service intent.")])])]),t._v(" "),s("p",[s("strong",[t._v("tiapp.xml")])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("ti:")]),t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("android")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("service")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("someService.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("interval"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("android")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("ti:")]),t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h3",{attrs:{id:"started-services"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#started-services"}},[t._v("#")]),t._v(" Started services")]),t._v(" "),s("p",[t._v("A started service is a service created "),s("strong",[t._v("and")]),t._v(" started using the "),s("code",[t._v("Titanium.Android")]),t._v(" API. The application creates an intent referencing the JavaScript code to run as a service, then starts the service. The service self manages itself after it starts.")]),t._v(" "),s("h4",{attrs:{id:"create-a-service-intent"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-a-service-intent"}},[t._v("#")]),t._v(" Create a service intent")]),t._v(" "),s("p",[t._v("To create a started service, create a service intent with the "),s("code",[t._v("Titanium.Android.createServiceIntent()")]),t._v(" method. Pass the method a dictionary with the "),s("code",[t._v("url")]),t._v(" property set to the URL of the JavaScript file that contains the code the application wants to run as a service. You can optionally set the "),s("code",[t._v("startMode")]),t._v(" property to either:")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("Titanium.Android.START_REDELIVER_INTENT")]),t._v(": Indicates to restart the service with the original intent if the application is destroyed. (Default)")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("Titanium.Android.START_NOT_STICKY")]),t._v(": Indicates not to restart the service if the application is destroyed.")])])]),t._v(" "),s("p",[t._v("To pass data to the service, use the Intent object's "),s("code",[t._v("putExtra()")]),t._v(" method to add extras to the intent. For details, see "),s("RouterLink",{attrs:{to:"/guide/Titanium_SDK/Titanium_SDK_How-tos/Platform_API_Deep_Dives/Android_API_Deep_Dives/Android_Intents/#add-extra-data"}},[t._v("Android Intents: Add extra data")]),t._v(".")],1),t._v(" "),s("p",[t._v("To set the interval for the service, use the "),s("code",[t._v("putExtra")]),t._v(" "),s("code",[t._v("()")]),t._v(" method, and set the property name to "),s("code",[t._v("interval")]),t._v(" and the value to how often to call the code in milliseconds.")]),t._v(" "),s("p",[t._v("The example below creates an intent to call the service every ten seconds.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SECONDS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// every 10 seconds")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" intent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Titanium"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServiceIntent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'someService.js'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nintent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("putExtra")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'interval'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SECONDS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Needs to be milliseconds")]),t._v("\n")])])]),s("h4",{attrs:{id:"start-a-started-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#start-a-started-service"}},[t._v("#")]),t._v(" Start a started service")]),t._v(" "),s("p",[t._v("To start a started service, pass the "),s("code",[t._v("Titanium.Android.startService()")]),t._v(" method a service intent object.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Titanium.Android.startService(intent);\n")])])]),s("h4",{attrs:{id:"stop-a-started-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#stop-a-started-service"}},[t._v("#")]),t._v(" Stop a started service")]),t._v(" "),s("p",[t._v("To stop a started service from the application, pass the "),s("code",[t._v("Titanium.Android.stopService()")]),t._v(" method the service intent object that was passed to the "),s("code",[t._v("startService()")]),t._v(" method.")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("ðŸ’¡ Hint")]),t._v(" "),s("p",[t._v("The service can stop itself by retrieving a reference to itself and calling its "),s("code",[t._v("stop()")]),t._v(" method.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Ti.Android.currentService.stop();\n")])])])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Titanium.Android.stopService(intent);\n")])])]),s("h4",{attrs:{id:"monitor-started-services"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#monitor-started-services"}},[t._v("#")]),t._v(" Monitor started services")]),t._v(" "),s("p",[t._v("The application can see if the service is still running by calling the "),s("code",[t._v("Titanium.Android.isServiceRunning()")]),t._v(" method and pass it the intent object that created the service.")]),t._v(" "),s("p",[t._v("The example below checks to see if the intent was used to start a service that is currently running. If not, it will start the service.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("if (!Ti.Android.isServiceRunning(intent)) {\n    Ti.Android.startService(intent);\n} else {\n    Ti.API.info('Service is already running.');\n}\n")])])]),s("h3",{attrs:{id:"bound-services"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bound-services"}},[t._v("#")]),t._v(" Bound services")]),t._v(" "),s("p",[t._v("A bound service is a service only created using the "),s("code",[t._v("Titanium.Android")]),t._v(" API. The application can manage the service using the "),s("code",[t._v("Titanium.Android.Service")]),t._v(" API to invoke the "),s("code",[t._v("start()")]),t._v(" and "),s("code",[t._v("stop()")]),t._v(" methods on it as well as bind some event callbacks to it.")]),t._v(" "),s("h4",{attrs:{id:"create-a-bound-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-a-bound-service"}},[t._v("#")]),t._v(" Create a bound service")]),t._v(" "),s("p",[t._v("To create a bound service, create a service intent with the"),s("code",[t._v("Titanium.Android.createServiceIntent()")]),t._v(" method, then pass the intent to the "),s("code",[t._v("Titanium.Android.createService()")]),t._v(" method to create a "),s("code",[t._v("Service")]),t._v(" object.")]),t._v(" "),s("p",[s("strong",[t._v("To create a service intent")]),t._v(", pass the method a dictionary with the "),s("code",[t._v("url")]),t._v(" property set to the URL of the JavaScript file that contains the code the application wants to run as a service. You can optionally set the "),s("code",[t._v("startMode")]),t._v(" property to either:")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("Titanium.Android.START_REDELIVER_INTENT")]),t._v(": Indicates to restart the service with the original intent if the application is destroyed. (Default)")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("Titanium.Android.START_NOT_STICKY")]),t._v(": Indicates not to restart the service if the application is destroyed.")])])]),t._v(" "),s("p",[t._v("To pass data to the service, use the Intent object's "),s("code",[t._v("putExtra()")]),t._v(" method to add extras to the intent. For details, see "),s("RouterLink",{attrs:{to:"/guide/Titanium_SDK/Titanium_SDK_How-tos/Platform_API_Deep_Dives/Android_API_Deep_Dives/Android_Intents/#AddExtraData"}},[t._v("Android Intents: Add Extra Data")]),t._v(".")],1),t._v(" "),s("p",[t._v("To set the interval for the service, use the "),s("code",[t._v("putExtra")]),t._v(" "),s("code",[t._v("()")]),t._v(" method, and set the property name to "),s("code",[t._v("interval")]),t._v(" and the value to how often to call the code in milliseconds.")]),t._v(" "),s("p",[s("strong",[t._v("To create the Service object")]),t._v(", pass the "),s("code",[t._v("Titanium.Android.createService()")]),t._v(" method the service intent object.")]),t._v(" "),s("p",[t._v("The example below creates an intent to call the service every ten seconds, then creates the service object.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" intent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServiceIntent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'someService.js'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nintent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("putExtra")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'interval'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SECONDS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" service "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Ti"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"manage-the-bound-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#manage-the-bound-service"}},[t._v("#")]),t._v(" Manage the bound service")]),t._v(" "),s("p",[t._v("Use the "),s("code",[t._v("Titanium.Android.Service")]),t._v(" API to manage some aspects of the bound service.")]),t._v(" "),s("p",[s("strong",[t._v("To start or stop the service")]),t._v(", call the Service object's "),s("code",[t._v("start()")]),t._v(" or "),s("code",[t._v("stop()")]),t._v(" methods, respectively.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("service.start();\n// Do stuff\nservice.stop();\n")])])]),s("p",[s("strong",[t._v("To monitor when the service starts or stops")]),t._v(", the application can bind event listeners to the "),s("code",[t._v("start")]),t._v(" and "),s("code",[t._v("stop")]),t._v(" events.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("service.addEventListener('start', doSomething);\nservice.addEventListener('stop', doSomethingElse);\n")])])]),s("h2",{attrs:{id:"simple-service-example"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#simple-service-example"}},[t._v("#")]),t._v(" Simple service example")]),t._v(" "),s("p",[t._v("This example shows a simple started service which does nothing other than write to logcat (the Android log). Not exciting, but it's a complete example from A to Z.")]),t._v(" "),s("h3",{attrs:{id:"write-your-service-javascript-code"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#write-your-service-javascript-code"}},[t._v("#")]),t._v(" Write your service Javascript code")]),t._v(" "),s("p",[t._v("Remember, these simple services execute code on an interval. The code that executes is defined by you in a JavaScript file, just like when you define other Titanium executable code. Create an application and add a file named (for this example) "),s("code",[t._v("logservice.js")]),t._v(" into the "),s("code",[t._v("app/lib")]),t._v(" folder for Alloy projects or "),s("code",[t._v("Resources")]),t._v(" folder for classic Titanium projects. Open the "),s("code",[t._v("logservice.js")]),t._v(" file in an editor and add the following code:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Titanium.API.info('Hello World, I am a Service');\n")])])]),s("p",[t._v("You can do all sorts of things in that JavaScript file, and everything you put in it will run every "),s("strong",[t._v("N")]),t._v(" milliseconds.")]),t._v(" "),s("h3",{attrs:{id:"update-the-tiapp-xml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update-the-tiapp-xml"}},[t._v("#")]),t._v(" Update the tiapp.xml")]),t._v(" "),s("p",[t._v("You need to let the Titanium builder know that this Javascript file you just created is meant to be the code that executes when a Service runs.")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Open the project's "),s("code",[t._v("tiapp.xml")]),t._v(" and add a "),s("code",[t._v("<services>")]),t._v(" element under the "),s("code",[t._v("<android>")]),t._v(" element.")])]),t._v(" "),s("li",[s("p",[t._v("Next, add a "),s("code",[t._v("<service>")]),t._v(" element under the "),s("code",[t._v("<services>")]),t._v(" element. Assign the "),s("code",[t._v("url")]),t._v(" attribute the name of the JavaScript file, which is "),s("code",[t._v("logservice.js")]),t._v(" and assign the "),s("code",[t._v("type")]),t._v(" attribute to "),s("code",[t._v("interval")])])])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("ti:")]),t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("android")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xmlns:")]),t._v("android")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://schemas.android.com/apk/res/android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("service")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("logservice.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("interval"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("android")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("ti:")]),t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("At this point, you've successfully defined the service. If you were to build your app right now and check the generated "),s("code",[t._v("AndroidManifest.xml")]),t._v(" in the "),s("code",[t._v("build/android")]),t._v(" folder, you would see an entry for the service:")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("service")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("android:")]),t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("com.billdawson.logservicedemo.LogserviceService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),s("h3",{attrs:{id:"write-some-code-to-start-the-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#write-some-code-to-start-the-service"}},[t._v("#")]),t._v(" Write some code to start the service")]),t._v(" "),s("p",[t._v("As we noted up in the introduction, one caveat about these simple services is that they are pretty much bound to the Titanium application in which you create them. In other words, the services will not get started and run successfully unless you start them from code inside the same application in which you define them. Modify your project's "),s("code",[t._v("app/alloy.js")]),t._v(" file for Alloy projects or "),s("code",[t._v("app.js")]),t._v(" file for classic Titanium projects to start the service.")]),t._v(" "),s("p",[t._v("For purposes of this example, all of the code examples that follow can just be put down at the bottom of your app's file so they run when the app starts.")]),t._v(" "),s("p",[t._v("First, create an intent in which we specify the JavaScript file to start using the "),s("code",[t._v("url")]),t._v(" property, and the interval (in milliseconds) at which it should run the code in its JavaScript file. Use "),s("code",[t._v("Ti.Android.createServiceIntent()")]),t._v(" to make the intent, then add the interval information to it using the intent's "),s("code",[t._v("putExtra()")]),t._v(" method:")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SECONDS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// every 10 seconds")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" intent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Titanium"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServiceIntent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'logservice.js'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nintent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("putExtra")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'interval'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SECONDS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Needs to be milliseconds")]),t._v("\n")])])]),s("p",[t._v("With the intent in hand, we need to tell Android to start the service defined by the intent:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Titanium.Android.startService(intent);\n")])])]),s("p",[t._v("That's it! Go ahead and start your application in an emulator or on your phone.")]),t._v(" "),s("h3",{attrs:{id:"write-some-code-to-stop-the-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#write-some-code-to-stop-the-service"}},[t._v("#")]),t._v(" Write some code to stop the service")]),t._v(" "),s("p",[t._v("Notice we did not write any code yet to actually "),s("strong",[t._v("stop")]),t._v(" the service once it's running. You can do that by calling "),s("code",[t._v("Titanium.Android.stopService()")]),t._v(' by passing it an intent that has the same information (or even the same intent object). (You do not need to set the "interval" extra in the intent if you are just stopping the service.)')]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" intent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Titanium"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServiceIntent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'logservice.js'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nTitanium"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stopService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"testing-notes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#testing-notes"}},[t._v("#")]),t._v(" Testing notes")]),t._v(" "),s("p",[t._v('While you are testing your service you can back out completely from the application, and the service should still continue to run and emit the "Hello World" statements to the log. However, if you back out of the application then launch it again, the service will get started a '),s("em",[t._v("second")]),t._v(" time, because your "),s("code",[t._v("app.js")]),t._v(" code will run again and call "),s("code",[t._v("Titanium.Android.startService()")]),t._v(". Behind the scenes, there is only one instance of the Service running (in Android terms, its "),s("code",[t._v("onCreate()")]),t._v(' has occurred only once, but it has been "started" twice, that is, its '),s("code",[t._v("onStart()")]),t._v(" has occurred twice). A new set of intervals will then queue up and your service code will run double the number of times. This may not be what you want, so you can call "),s("code",[t._v("Titanium.Android.isServiceRunning()")]),t._v(" by passing it the same intent that you would use to start the service. Then you can conditionally start it only if it is not already running.")]),t._v(" "),s("h2",{attrs:{id:"other-examples"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#other-examples"}},[t._v("#")]),t._v(" Other examples")]),t._v(" "),s("p",[t._v("See the following for other examples of services:")]),t._v(" "),s("ul",[s("li",[t._v("KitchenSink's "),s("a",{attrs:{href:"https://github.com/appcelerator/KitchenSink/blob/stable/Resources/ui/handheld/android/platform/android_services.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("android_services.js"),s("OutboundLink")],1),t._v(" script")])]),t._v(" "),s("h2",{attrs:{id:"further-reading"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#further-reading"}},[t._v("#")]),t._v(" Further reading")]),t._v(" "),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"#!/api/Titanium.Android"}},[t._v("Titanium.Android API Reference")])])]),t._v(" "),s("li",[s("p",[s("a",{attrs:{href:"http://developer.android.com/guide/components/services.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Android Developer: Services"),s("OutboundLink")],1)])])])])}),[],!1,null,null,null);e.default=n.exports}}]);